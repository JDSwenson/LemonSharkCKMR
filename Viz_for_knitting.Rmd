---
title: "For knitting viz"
author: "JDS"
date: "5/13/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(tidyverse)
library(ggpubr)
```

The half-sibling CKMR model has been producing biased results for the last several months. So, I returned to old code where the model appeared to be working better. I compared bias from the new and old scripts and determined that the old script works better. However, it still suffers from a positive bias. So, I started testing some basic considerations to see if I could drive the bias down and gain an understanding of what went wrong with the "new" code.


**05/27/2021**
fishSim: set seed to one number vs random numbers.
I ran this simulation after talking with Dovi and Charlotte to see if the persistent positive bias arises from the seed I was using. The results shown below suggest that this is not the case.
```{r}
#single number seed
IBS.null_Lemon_single_seed <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/fishSim_model_validation/Lemon_Sharks/results/length_of_sampling/six_year_sampling/*05.12.2021.csv")
IBS.null_Lemon_single_seed.df <- sapply(IBS.null_Lemon_single_seed, read_csv, simplify=FALSE) %>% 
bind_rows() %>% 
  mutate(Sex = factor(Sex, levels = c("M", "F", "All")))

IBS.null_Lemon_random_seed <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/fishSim_model_validation/Lemon_Sharks/results/length_of_sampling/six_year_sampling/*05.26.2021.csv")
IBS.null_Lemon_random_seed.df <- sapply(IBS.null_Lemon_random_seed, read_csv, simplify=FALSE) %>% 
bind_rows() %>% 
  mutate(Sex = factor(Sex, levels = c("M", "F", "All")))

head(IBS.null_Lemon_single_seed.df)
head(IBS.null_Lemon_random_seed.df)
#years_sampled <- 6

IBS.null_Lemon_single_seed.df <- IBS.null_Lemon_single_seed.df %>% mutate(Samples_per_year = Total_samples/6) %>% 
  mutate(Percent_sampled = (Samples_per_year/Pop_size_mean)*100)

IBS.null_Lemon_random_seed.df <- IBS.null_Lemon_random_seed.df %>% mutate(Samples_per_year = Total_samples/10) %>% 
  mutate(Percent_sampled = (Samples_per_year/Pop_size_mean)*100)

IBS.null_Lemon_single_seed.df %>% group_by(Sex, Total_samples) %>% summarize(median(Relative_bias))

IBS.null_Lemon_random_seed.df %>% group_by(Sex, Total_samples) %>% summarize(median(Relative_bias))


Single_seed_Box <- ggplot(data=IBS.null_Lemon_single_seed.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias single seed") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

Random_seed_Box <- ggplot(data=IBS.null_Lemon_random_seed.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias random seed") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

Single_seed_Scatter <- ggplot(data=IBS.null_Lemon_single_seed.df, aes(x=Percent_sampled)) +
  geom_jitter(aes(y=Relative_bias, color=Sex)) +
  ylim(-50, 100) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin = min(IBS.null_Lemon_single_seed.df$Percent_sampled), xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Percent sampled", y="Relative bias", title="Relative bias single seed") +
  scale_color_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")


Random_seed_Scatter <- ggplot(data=IBS.null_Lemon_random_seed.df, aes(x=Percent_sampled)) +
  geom_jitter(aes(y=Relative_bias, color=Sex)) +
  ylim(-50, 100) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin = min(IBS.null_Lemon_random_seed.df$Percent_sampled), xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Percent sampled", y="Relative bias", title="Relative bias random seed") +
  scale_color_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")


ggarrange(Single_seed_Box, Random_seed_Box, Single_seed_Scatter, Random_seed_Scatter)
```

**05/27/2021**
Dovi IBS: make mating periodicity 1 so we discount skipped-breeding as the potential source of bias.

```{r}
#null model results
DoviIBS_Lemon_skip <- Sys.glob("~/R/R_working_dir/LemonSharkCKMR_GitHub/02_IBS/Dovi_IBS_model_validation/Lemon_sharks/results/length_of_sampling/six_year_sampling/*6yrs.csv")
DoviIBS_Lemon_skip.df <- sapply(DoviIBS_Lemon_skip, read_csv, simplify=FALSE) %>% 
bind_rows() %>%
  mutate(Sex = factor(Sex, levels = c("M", "F", "All")))

#Use pre-mort script for old version
DoviIBS_Lemon_noskip <- Sys.glob("~/R/R_working_dir/LemonSharkCKMR_GitHub/02_IBS/Dovi_IBS_model_validation/Lemon_sharks/results/length_of_sampling/six_year_sampling/*noskip.csv")
DoviIBS_Lemon_noskip.df <- sapply(DoviIBS_Lemon_noskip, read_csv, simplify=FALSE) %>% 
bind_rows() %>%
  mutate(Sex = factor(Sex, levels = c("M", "F", "All")))

#Calculate percent of population sampled
DoviIBS_Lemon_skip.df <- DoviIBS_Lemon_skip.df %>% mutate(Samples_per_year = Total_samples/6) %>% 
  mutate(Percent_sampled = (Samples_per_year/Pop_size_mean)*100)

DoviIBS_Lemon_noskip.df <- DoviIBS_Lemon_noskip.df %>% mutate(Samples_per_year = Total_samples/10) %>% 
  mutate(Percent_sampled = (Samples_per_year/Pop_size_mean)*100)

DoviIBS_Lemon_skip.df %>% group_by(Sex, Total_samples) %>% summarize(median(Relative_bias))

DoviIBS_Lemon_noskip.df %>% group_by(Sex, Total_samples) %>% summarize(median(Relative_bias))


#Box plots
DoviLemon_skip.Box <- ggplot(data=DoviIBS_Lemon_skip.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias Lemon shark w/ skipped-breeding") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

DoviLemon_noskip.Box <- ggplot(data=DoviIBS_Lemon_noskip.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias Lemon shark no skipped-breeding") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")


#Scatter plots
Skip_Scatter <- ggplot(data=DoviIBS_Lemon_skip.df, aes(x=Percent_sampled)) +
  geom_jitter(aes(y=Relative_bias, color=Sex)) +
  ylim(-50, 100) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin = min(DoviIBS_Lemon_skip.df$Percent_sampled), xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Percent sampled", y="Relative bias", title="Relative bias skipped-breeding") +
  scale_color_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")


Noskip_Scatter <- ggplot(data=DoviIBS_Lemon_noskip.df, aes(x=Percent_sampled)) +
  geom_jitter(aes(y=Relative_bias, color=Sex)) +
  ylim(-50, 100) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin = min(DoviIBS_Lemon_noskip.df$Percent_sampled), xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Percent sampled", y="Relative bias", title="Relative bias no skipped-breeding") +
  scale_color_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

ggarrange(DoviLemon_skip.Box, DoviLemon_noskip.Box, Skip_Scatter, Noskip_Scatter, common.legend = TRUE)
```


New vs old model
```{r echo = FALSE}
#null model results
IBS.null_Lemon_new <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/fishSim_model_validation/Lemon_Sharks/results/z_old/new_model/*05.10.2021.csv")
IBS.null_Lemon_new.df <- sapply(IBS.null_Lemon_new, read_csv, simplify=FALSE) %>% 
bind_rows() %>%
  mutate(Sex = factor(Sex, levels = c("M", "F", "All")))

#Use pre-mort script for old version
IBS.null_Lemon_old <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/fishSim_model_validation/Lemon_Sharks/results/pre_vs_post-census/sex-specific_capture_before_mort/*05.11.2021.csv")
IBS.null_Lemon_old.df <- sapply(IBS.null_Lemon_old, read_csv, simplify=FALSE) %>% 
bind_rows() %>%
  mutate(Sex = factor(Sex, levels = c("M", "F", "All")))

#IBS_null_demo <- Sys.glob("~/R/R_working_dir/LemonSharkCKMR_GitHub/02_IBS/Dovi_IBS_model_validation/demographic_output/*04.13.2021_demographic.out.csv")
#IBS.null_demo <- sapply(IBS_null_demo, read_csv, simplify=FALSE) %>% 
#bind_rows() #%>% 
  #drop_na()

#IBS.null_2 <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/IBS_simulations/Dovi_IBS_results/*03.02.2021.N.csv")
#IBS.null_results_2 <- sapply(IBS.null_2, read_csv, simplify=FALSE) %>% 
#bind_rows() #%>% 
  #drop_na()

new.plot <- ggplot(data=IBS.null_Lemon_new.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias fishSim \"new\" model") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

old.plot <- ggplot(data=IBS.null_Lemon_old.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias fishSim \"old\" model") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

ggarrange(new.plot, old.plot, common.legend = TRUE)
```


fishSim
Back to the basics: Compare pre- vs post-breeding census i.e. capture before mortality vs after
```{r}
#null model results
IBS.null_Lemon_b4_mort <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/fishSim_model_validation/Lemon_Sharks/results/pre_vs_post-census/sex-specific_capture_before_mort/*05.11.2021.csv")
IBS.null_Lemon_b4_mort.df <- sapply(IBS.null_Lemon_b4_mort, read_csv, simplify=FALSE) %>% 
bind_rows() #%>% 
  #drop_na()

IBS.null_Lemon_after_mort <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/fishSim_model_validation/Lemon_Sharks/results/pre_vs_post-census/sex-specific_capture_after_mort/*05.11.2021.csv")
IBS.null_Lemon_after_mort.df <- sapply(IBS.null_Lemon_after_mort, read_csv, simplify=FALSE) %>% 
bind_rows() #%>% 
  #drop_na()

years_sampled <- 6

IBS.null_results_Lemon <- IBS.null_results_Lemon %>% mutate(Samples_per_year = Total_samples/years_sampled) %>% 
  mutate(Percent_sampled = (Samples_per_year/Pop_size_mean)*100)


b4_mort_Box <- ggplot(data=IBS.null_Lemon_b4_mort.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias fishSim old model: capture before mort") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

after_mort_Box <- ggplot(data=IBS.null_Lemon_after_mort.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias fishSim old model: capture after mort") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

# NullIBS_Scatter <- ggplot(data=IBS.null_results_Lemon, aes(x=Percent_sampled)) +
#   geom_jitter(aes(y=Relative_bias, color=Sex)) +
#   ylim(-50, 100) +
#   geom_hline(yintercept=0, col="black", size=1.25) +
#   annotate("rect", xmin = min(IBS.null_results_Lemon$Percent_sampled), xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
#   labs(x="Percent sampled", y="Relative bias", title="Relative bias fishSim sex-combined and sex-aggregated") +
#   scale_fill_brewer(palette="Set2") +
#   font("title", size = 10, face = "bold")

ggarrange(b4_mort_Box, after_mort_Box, common.legend = TRUE)
```



fishSim
Compare length of sampling: 6 years vs 10 years
```{r}
#null model results
IBS.null_Lemon_6yrs <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/fishSim_model_validation/Lemon_Sharks/results/length_of_sampling/six_year_sampling/*05.12.2021.csv")
IBS.null_Lemon_6yrs.df <- sapply(IBS.null_Lemon_6yrs, read_csv, simplify=FALSE) %>% 
bind_rows() %>% 
  mutate(Sex = factor(Sex, levels = c("M", "F", "All")))

IBS.null_Lemon_10yrs <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/fishSim_model_validation/Lemon_Sharks/results/length_of_sampling/ten_year_sampling/*05.12.2021.csv")
IBS.null_Lemon_10yrs.df <- sapply(IBS.null_Lemon_10yrs, read_csv, simplify=FALSE) %>% 
bind_rows() %>% 
  mutate(Sex = factor(Sex, levels = c("M", "F", "All")))

head(IBS.null_Lemon_6yrs.df)
head(IBS.null_Lemon_10yrs.df)
#years_sampled <- 6

IBS.null_Lemon_6yrs.df <- IBS.null_Lemon_6yrs.df %>% mutate(Samples_per_year = Total_samples/6) %>% 
  mutate(Percent_sampled = (Samples_per_year/Pop_size_mean)*100)

IBS.null_Lemon_10yrs.df <- IBS.null_Lemon_10yrs.df %>% mutate(Samples_per_year = Total_samples/10) %>% 
  mutate(Percent_sampled = (Samples_per_year/Pop_size_mean)*100)

IBS.null_Lemon_6yrs.df %>% group_by(Sex, Total_samples) %>% summarize(median(Relative_bias))

IBS.null_Lemon_10yrs.df %>% group_by(Sex, Total_samples) %>% summarize(median(Relative_bias))



Six_yrs_Box <- ggplot(data=IBS.null_Lemon_6yrs.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias 6 year sample scheme") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

Ten_yrs_Box <- ggplot(data=IBS.null_Lemon_10yrs.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias 10 year sample scheme") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

Six_yrs_Scatter <- ggplot(data=IBS.null_Lemon_6yrs.df, aes(x=Percent_sampled)) +
  geom_jitter(aes(y=Relative_bias, color=Sex)) +
  ylim(-50, 100) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin = min(IBS.null_Lemon_6yrs.df$Percent_sampled), xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Percent sampled", y="Relative bias", title="Relative bias 6 year sample scheme") +
  scale_color_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")


Ten_yrs_Scatter <- ggplot(data=IBS.null_Lemon_10yrs.df, aes(x=Percent_sampled)) +
  geom_jitter(aes(y=Relative_bias, color=Sex)) +
  ylim(-50, 100) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin = min(IBS.null_Lemon_10yrs.df$Percent_sampled), xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Percent sampled", y="Relative bias", title="Relative bias 10 year sample scheme") +
  scale_color_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")


ggarrange(Six_yrs_Box, Ten_yrs_Box, Six_yrs_Scatter, Ten_yrs_Scatter)
```


Dovi IBS results: Lemon Shark vs Cownose Ray
```{r}
#null model results
DoviIBS.null_Lemon_6yrs <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/Dovi_IBS_model_validation/Lemon_sharks/results/length_of_sampling/six_year_sampling/*.csv")
DoviIBS.null_Lemon_6yrs.df <- sapply(DoviIBS.null_Lemon_6yrs, read_csv, simplify=FALSE) %>% 
bind_rows() %>%
  mutate(Sex = factor(Sex, levels = c("M", "F", "All")))

#Use pre-mort script for old version
DoviIBS.null_CNR_6yrs <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/Dovi_IBS_model_validation/Cownose_rays/results/length_of_sampling/six_year_sampling/*.csv")
DoviIBS.null_CNR_6yrs.df <- sapply(DoviIBS.null_CNR_6yrs, read_csv, simplify=FALSE) %>% 
bind_rows() %>%
  mutate(Sex = factor(Sex, levels = c("M", "F", "All")))


DoviLemon.plot <- ggplot(data=DoviIBS.null_Lemon_6yrs.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias Lemon shark") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

DoviCNR.plot <- ggplot(data=DoviIBS.null_CNR_6yrs.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias Cownose ray") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")

ggarrange(DoviLemon.plot, DoviCNR.plot, common.legend = TRUE)
```








More recent model with bias
```{r}
#null model results
IBS.null_Lemon <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/02_IBS/fishSim_model_validation/Lemon_Sharks/results/z_old/new_model/*05.10.2021.csv")
IBS.null_Lemon.df <- sapply(IBS.null_Lemon, read_csv, simplify=FALSE) %>% 
bind_rows() #%>% 
  #drop_na()

#IBS_null_demo <- Sys.glob("~/R/R_working_dir/LemonSharkCKMR_GitHub/02_IBS/Dovi_IBS_model_validation/demographic_output/*04.13.2021_demographic.out.csv")
#IBS.null_demo <- sapply(IBS_null_demo, read_csv, simplify=FALSE) %>% 
#bind_rows() #%>% 
  #drop_na()

#IBS.null_2 <- Sys.glob("~/R/R_working_dir/CKMR/LemonSharkCKMR_GitHub/IBS_simulations/Dovi_IBS_results/*03.02.2021.N.csv")
#IBS.null_results_2 <- sapply(IBS.null_2, read_csv, simplify=FALSE) %>% 
#bind_rows() #%>% 
  #drop_na()

ggplot(data=IBS.null_Lemon.df, aes(x=factor(Total_samples))) +
  geom_boxplot(aes(y=Relative_bias, fill=Sex)) +
  ylim(-50, 160) +
  geom_hline(yintercept=0, col="black", size=1.25) +
  annotate("rect", xmin=0, xmax=Inf, ymin=-20, ymax=20, alpha=.5, col="red") +
  labs(x="Sample size", y="Relative bias", title="Relative bias fishSim new model: sex-combined and sex-aggregated") +
  scale_fill_brewer(palette="Set2") +
  font("title", size = 10, face = "bold")
```